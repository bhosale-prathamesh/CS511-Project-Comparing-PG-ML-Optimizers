q1#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA')      or (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q2#####select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1993-06-05'   and o_orderdate < date '1993-06-05' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;
q3#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'ALGERIA' and n2.n_name = 'EGYPT')      or (n1.n_name = 'EGYPT' and n2.n_name = 'ALGERIA')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q4#####select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1993-04-01'   and o_orderdate < date '1993-04-01' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;
q5#####select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1994-10-05'   and o_orderdate < date '1994-10-05' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;
q6#####select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'EUROPE'   and o_orderdate >= date '1996-01-10'   and o_orderdate < date '1996-01-10' + interval '1' year  group by   n_name  order by   revenue desc;
q7#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'EGYPT' and n2.n_name = 'ALGERIA')      or (n1.n_name = 'ALGERIA' and n2.n_name = 'EGYPT')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q8#####select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'ASIA'   and o_orderdate >= date '1995-01-01'   and o_orderdate < date '1995-01-01' + interval '1' year  group by   n_name  order by   revenue desc;
q9#####select   o_year,   sum(case    when nation = 'MOZAMBIQUE' then volume    else 0   end) / sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'AFRICA'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'SMALL BRUSHED TIN'   ) as all_nations  group by   o_year  order by   o_year;
q10#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'BRAZIL' and n2.n_name = 'CANADA')      or (n1.n_name = 'CANADA' and n2.n_name = 'BRAZIL')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q11#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'ROMANIA' and n2.n_name = 'INDIA')      or (n1.n_name = 'INDIA' and n2.n_name = 'ROMANIA')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q12#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'VIETNAM' and n2.n_name = 'RUSSIA')      or (n1.n_name = 'RUSSIA' and n2.n_name = 'VIETNAM')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q13#####select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1994-09-02'   and o_orderdate < date '1994-09-02' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;
q14#####select   c_custkey,   c_name,   sum(l_extendedprice * (1 - l_discount)) as revenue,   c_acctbal,   n_name,   c_address,   c_phone,   c_comment  from   customer,   orders,   lineitem,   nation  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and o_orderdate >= date '1995-01-01'   and o_orderdate < date '1995-01-01' + interval '3' month   and l_returnflag = 'R'   and c_nationkey = n_nationkey  group by   c_custkey,   c_name,   c_acctbal,   c_phone,   n_name,   c_address,   c_comment  order by   revenue desc;
q15#####select   o_year,   sum(case    when nation = 'EGYPT' then volume    else 0   end) / sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'MIDDLE EAST'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'STANDARD ANODIZED STEEL'   ) as all_nations  group by   o_year  order by   o_year;
q16#####select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'MIDDLE EAST'   and o_orderdate >= date '1994-01-01'   and o_orderdate < date '1994-01-01' + interval '1' year  group by   n_name  order by   revenue desc;
q17#####select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'ASIA'   and o_orderdate >= date '1997-01-10'   and o_orderdate < date '1997-01-10' + interval '1' year  group by   n_name  order by   revenue desc;
q18#####select   n_name,   sum(l_extendedprice * (1 - l_discount)) as revenue  from   customer,   orders,   lineitem,   supplier,   nation,   region  where   c_custkey = o_custkey   and l_orderkey = o_orderkey   and l_suppkey = s_suppkey   and c_nationkey = s_nationkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'MIDDLE EAST'   and o_orderdate >= date '1996-01-01'   and o_orderdate < date '1996-01-01' + interval '1' year  group by   n_name  order by   revenue desc;
q19#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'IRAN' and n2.n_name = 'IRAQ')      or (n1.n_name = 'IRAQ' and n2.n_name = 'IRAN')     )     and l_shipdate between date '1995-01-02' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q20#####select   o_year,   sum(case    when nation = 'GERMANY' then volume    else 0   end) / sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'EUROPE'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'MEDIUM PLATED COPPER'   ) as all_nations  group by   o_year  order by   o_year;
q21#####select   supp_nation,   cust_nation,   l_year,   sum(volume) as revenue  from   (    select     n1.n_name as supp_nation,     n2.n_name as cust_nation,     extract(year from l_shipdate) as l_year,     l_extendedprice * (1 - l_discount) as volume    from     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2    where     s_suppkey = l_suppkey     and o_orderkey = l_orderkey     and c_custkey = o_custkey     and s_nationkey = n1.n_nationkey     and c_nationkey = n2.n_nationkey     and (      (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'GERMANY')      or (n1.n_name = 'GERMANY' and n2.n_name = 'MOZAMBIQUE')     )     and l_shipdate between date '1995-01-01' and date '1996-12-31'   ) as shipping  group by   supp_nation,   cust_nation,   l_year  order by   supp_nation,   cust_nation,   l_year;
q22#####select   o_year,   sum(case    when nation = 'CANADA' then volume    else 0   end) / sum(volume) as mkt_share  from   (    select     extract(year from o_orderdate) as o_year,     l_extendedprice * (1 - l_discount) as volume,     n2.n_name as nation    from     part,     supplier,     lineitem,     orders,     customer,     nation n1,     nation n2,     region    where     p_partkey = l_partkey     and s_suppkey = l_suppkey     and l_orderkey = o_orderkey     and o_custkey = c_custkey     and c_nationkey = n1.n_nationkey     and n1.n_regionkey = r_regionkey     and r_name = 'AMERICA'     and s_nationkey = n2.n_nationkey     and o_orderdate between date '1995-01-01' and date '1996-12-31'     and p_type = 'LARGE PLATED BRASS'   ) as all_nations  group by   o_year  order by   o_year;